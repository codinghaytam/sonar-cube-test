


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > TransactionService</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.university.finance.service</a>
</div>

<h1>Coverage Summary for Class: TransactionService (com.university.finance.service)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">TransactionService</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    90.9%
  </span>
  <span class="absValue">
    (10/11)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    64.3%
  </span>
  <span class="absValue">
    (18/28)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    71.1%
  </span>
  <span class="absValue">
    (59/83)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package com.university.finance.service;
&nbsp;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.List;
&nbsp;import java.util.UUID;
&nbsp;
&nbsp;import com.university.finance.model.Account;
&nbsp;import com.university.finance.model.Transaction;
&nbsp;import com.university.finance.pattern.strategy.DepositStrategy;
&nbsp;import com.university.finance.pattern.strategy.TransactionStrategy;
&nbsp;import com.university.finance.pattern.strategy.TransferStrategy;
&nbsp;import com.university.finance.pattern.strategy.WithdrawStrategy;
&nbsp;
&nbsp;// Service spécialisé pour la gestion des opérations de transaction
&nbsp;// Coordonne les opérations de dépôt, retrait et transfert entre comptes
&nbsp;// Implémente le pattern Strategy en servant de contexte pour les stratégies de transaction
&nbsp;public class TransactionService {
&nbsp;    private BankingService bankingService;
&nbsp;    private TransactionStrategy currentStrategy; // Contexte pour le pattern Strategy
&nbsp;    
&nbsp;    // Constructeur avec injection de dépendance
<b class="fc">&nbsp;    public TransactionService(BankingService bankingService) {</b>
<b class="fc">&nbsp;        this.bankingService = bankingService;</b>
<b class="fc">&nbsp;        this.currentStrategy = null;</b>
&nbsp;    }
&nbsp;    
&nbsp;    // Définit la stratégie courante à utiliser
&nbsp;    public void setStrategy(TransactionStrategy strategy) {
<b class="fc">&nbsp;        this.currentStrategy = strategy;</b>
&nbsp;    }
&nbsp;    
&nbsp;    // Effectue un dépôt sur un compte
&nbsp;    public boolean deposit(String accountId, double amount) {
<b class="fc">&nbsp;        Account account = bankingService.getAccount(accountId);</b>
<b class="fc">&nbsp;        if (account == null) {</b>
<b class="fc">&nbsp;            System.out.println(&quot;Compte non trouvé: &quot; + accountId);</b>
<b class="fc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;        
<b class="pc">&nbsp;        if (amount &lt;= 0) {</b>
<b class="nc">&nbsp;            System.out.println(&quot;Le montant du dépôt doit être positif&quot;);</b>
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;        
&nbsp;        try {
&nbsp;            // Utiliser la stratégie de dépôt dans le contexte
<b class="fc">&nbsp;            setStrategy(new DepositStrategy());</b>
<b class="fc">&nbsp;            currentStrategy.execute(account, amount);</b>
&nbsp;            
&nbsp;            // Notifier le service bancaire de la transaction
<b class="fc">&nbsp;            bankingService.recordTransaction(</b>
<b class="fc">&nbsp;                UUID.randomUUID().toString(),</b>
&nbsp;                accountId,
&nbsp;                &quot;DEPOSIT&quot;,
&nbsp;                amount,
&nbsp;                &quot;Dépôt de &quot; + amount + &quot; effectué&quot;
&nbsp;            );
&nbsp;            
<b class="fc">&nbsp;            System.out.println(&quot;Dépôt de &quot; + amount + &quot; effectué avec succès sur le compte &quot; + accountId);</b>
<b class="fc">&nbsp;            return true;</b>
&nbsp;        } catch (Exception e) {
<b class="nc">&nbsp;            System.out.println(&quot;Erreur lors du dépôt: &quot; + e.getMessage());</b>
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    // Effectue un retrait d&#39;un compte
&nbsp;    public boolean withdraw(String accountId, double amount) {
<b class="fc">&nbsp;        Account account = bankingService.getAccount(accountId);</b>
<b class="pc">&nbsp;        if (account == null) {</b>
<b class="nc">&nbsp;            System.out.println(&quot;Compte non trouvé: &quot; + accountId);</b>
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;        
<b class="pc">&nbsp;        if (amount &lt;= 0) {</b>
<b class="nc">&nbsp;            System.out.println(&quot;Le montant du retrait doit être positif&quot;);</b>
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;        
&nbsp;        // Vérifier le solde
<b class="fc">&nbsp;        if (account.getBalance() &lt; amount) {</b>
<b class="fc">&nbsp;            System.out.println(&quot;Solde insuffisant pour le retrait&quot;);</b>
<b class="fc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;        
&nbsp;        try {
&nbsp;            // Utiliser la stratégie de retrait dans le contexte
<b class="fc">&nbsp;            setStrategy(new WithdrawStrategy());</b>
<b class="fc">&nbsp;            currentStrategy.execute(account, amount);</b>
&nbsp;            
&nbsp;            // Notifier le service bancaire de la transaction
<b class="fc">&nbsp;            bankingService.recordTransaction(</b>
<b class="fc">&nbsp;                UUID.randomUUID().toString(),</b>
&nbsp;                accountId,
&nbsp;                &quot;WITHDRAW&quot;,
&nbsp;                amount,
&nbsp;                &quot;Retrait de &quot; + amount + &quot; effectué&quot;
&nbsp;            );
&nbsp;            
<b class="fc">&nbsp;            System.out.println(&quot;Retrait de &quot; + amount + &quot; effectué avec succès du compte &quot; + accountId);</b>
<b class="fc">&nbsp;            return true;</b>
&nbsp;        } catch (Exception e) {
<b class="nc">&nbsp;            System.out.println(&quot;Erreur lors du retrait: &quot; + e.getMessage());</b>
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    // Effectue un transfert entre deux comptes
&nbsp;    public boolean transfer(String fromAccountId, String toAccountId, double amount) {
<b class="fc">&nbsp;        Account fromAccount = bankingService.getAccount(fromAccountId);</b>
<b class="fc">&nbsp;        Account toAccount = bankingService.getAccount(toAccountId);</b>
&nbsp;        
<b class="pc">&nbsp;        if (fromAccount == null) {</b>
<b class="nc">&nbsp;            System.out.println(&quot;Compte source non trouvé: &quot; + fromAccountId);</b>
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;        
<b class="fc">&nbsp;        if (toAccount == null) {</b>
<b class="fc">&nbsp;            System.out.println(&quot;Compte destination non trouvé: &quot; + toAccountId);</b>
<b class="fc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;        
<b class="pc">&nbsp;        if (amount &lt;= 0) {</b>
<b class="nc">&nbsp;            System.out.println(&quot;Le montant du transfert doit être positif&quot;);</b>
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;        
&nbsp;        // Vérifier le solde du compte source
<b class="pc">&nbsp;        if (fromAccount.getBalance() &lt; amount) {</b>
<b class="nc">&nbsp;            System.out.println(&quot;Solde insuffisant pour le transfert&quot;);</b>
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;        
&nbsp;        try {
&nbsp;            // Utiliser la stratégie de transfert dans le contexte
<b class="fc">&nbsp;            setStrategy(new TransferStrategy(toAccount));</b>
<b class="fc">&nbsp;            currentStrategy.execute(fromAccount, amount);</b>
&nbsp;            
&nbsp;            // Notifier le service bancaire des transactions
<b class="fc">&nbsp;            bankingService.recordTransaction(</b>
<b class="fc">&nbsp;                UUID.randomUUID().toString(),</b>
&nbsp;                fromAccountId,
&nbsp;                &quot;TRANSFER_OUT&quot;,
&nbsp;                amount,
&nbsp;                &quot;Transfert de &quot; + amount + &quot; vers le compte &quot; + toAccountId
&nbsp;            );
&nbsp;            
<b class="fc">&nbsp;            bankingService.recordTransaction(</b>
<b class="fc">&nbsp;                UUID.randomUUID().toString(),</b>
&nbsp;                toAccountId,
&nbsp;                &quot;TRANSFER_IN&quot;,
&nbsp;                amount,
&nbsp;                &quot;Réception de &quot; + amount + &quot; du compte &quot; + fromAccountId
&nbsp;            );
&nbsp;            
<b class="fc">&nbsp;            System.out.println(&quot;Transfert de &quot; + amount + &quot; du compte &quot; + fromAccountId + &quot; vers le compte &quot; + toAccountId + &quot; effectué avec succès&quot;);</b>
<b class="fc">&nbsp;            return true;</b>
&nbsp;        } catch (Exception e) {
<b class="nc">&nbsp;            System.out.println(&quot;Erreur lors du transfert: &quot; + e.getMessage());</b>
<b class="nc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;    
&nbsp;    // Récupère l&#39;historique complet des transactions
&nbsp;    public List&lt;Transaction&gt; getTransactionHistory() {
<b class="fc">&nbsp;        return bankingService.getTransactionHistory();</b>
&nbsp;    }
&nbsp;    
&nbsp;    // Récupère l&#39;historique des transactions pour un compte spécifique
&nbsp;    public List&lt;Transaction&gt; getTransactionHistoryForAccount(String accountId) {
<b class="fc">&nbsp;        List&lt;Transaction&gt; allTransactions = bankingService.getTransactionHistory();</b>
<b class="fc">&nbsp;        List&lt;Transaction&gt; accountTransactions = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;        for (Transaction transaction : allTransactions) {</b>
<b class="fc">&nbsp;            if (transaction.getAccountId().equals(accountId)) {</b>
<b class="fc">&nbsp;                accountTransactions.add(transaction);</b>
&nbsp;            }
&nbsp;        }
<b class="fc">&nbsp;        return accountTransactions;</b>
&nbsp;    }
&nbsp;    
&nbsp;    // Récupère les transactions par type (DEPOSIT, WITHDRAW, etc.)
&nbsp;    public List&lt;Transaction&gt; getTransactionsByType(String transactionType) {
<b class="nc">&nbsp;        List&lt;Transaction&gt; allTransactions = bankingService.getTransactionHistory();</b>
<b class="nc">&nbsp;        List&lt;Transaction&gt; filteredTransactions = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;        for (Transaction transaction : allTransactions) {</b>
<b class="nc">&nbsp;            if (transaction.getTransactionType().equals(transactionType)) {</b>
<b class="nc">&nbsp;                filteredTransactions.add(transaction);</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return filteredTransactions;</b>
&nbsp;    }
&nbsp;    
&nbsp;    // Récupère les transactions les plus récentes
&nbsp;    public List&lt;Transaction&gt; getRecentTransactions(int limit) {
<b class="fc">&nbsp;        List&lt;Transaction&gt; allTransactions = bankingService.getTransactionHistory();</b>
<b class="fc">&nbsp;        int size = allTransactions.size();</b>
<b class="fc">&nbsp;        int fromIndex = Math.max(0, size - limit);</b>
<b class="fc">&nbsp;        List&lt;Transaction&gt; recentTransactions = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;        for (int i = fromIndex; i &lt; size; i++) {</b>
<b class="fc">&nbsp;            recentTransactions.add(allTransactions.get(i));</b>
&nbsp;        }
<b class="fc">&nbsp;        return recentTransactions;</b>
&nbsp;    }
&nbsp;    
&nbsp;    // Récupère le nombre total de transactions
&nbsp;    public int getTransactionCount() {
<b class="fc">&nbsp;        return bankingService.getTransactionHistory().size();</b>
&nbsp;    }
&nbsp;    
&nbsp;    // Récupère le nombre de transactions pour un compte spécifique
&nbsp;    public int getTransactionCountForAccount(String accountId) {
<b class="fc">&nbsp;        return getTransactionHistoryForAccount(accountId).size();</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2025-12-18 11:35</div>
</div>
</body>
</html>
